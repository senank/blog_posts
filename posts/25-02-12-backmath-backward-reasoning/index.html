<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step | Senan Kassem&#39;s Paper Reviews</title>
<meta name="keywords" content="NLP, Transformers, Deep Learning, Chain of Thought, Reinforcement Learning, Supervised Training/Fine-Tuning">
<meta name="description" content="A review of the BackMATH paper, covering its impact on training models for reasoning, key insights, and future directions.">
<meta name="author" content="">
<link rel="canonical" href="https://senankassem.com/posts/25-02-12-backmath-backward-reasoning/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f29b4ec3ee6e98a9ec1a9a51adb5b1bf468ca1f94fcea7e42282ee958b7e23e5.css" integrity="sha256-8ptOw&#43;5umKnsGppRrbWxv0aMoflPzqfkIoLulYt&#43;I&#43;U=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://senankassem.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://senankassem.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://senankassem.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://senankassem.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://senankassem.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://senankassem.com/posts/25-02-12-backmath-backward-reasoning/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://senankassem.com/posts/25-02-12-backmath-backward-reasoning/">
  <meta property="og:site_name" content="Senan Kassem&#39;s Paper Reviews">
  <meta property="og:title" content="BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step">
  <meta property="og:description" content="A review of the BackMATH paper, covering its impact on training models for reasoning, key insights, and future directions.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-12T15:10:31+00:00">
    <meta property="article:modified_time" content="2025-02-12T15:10:31+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step">
<meta name="twitter:description" content="A review of the BackMATH paper, covering its impact on training models for reasoning, key insights, and future directions.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://senankassem.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step",
      "item": "https://senankassem.com/posts/25-02-12-backmath-backward-reasoning/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step",
  "name": "BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step",
  "description": "A review of the BackMATH paper, covering its impact on training models for reasoning, key insights, and future directions.",
  "keywords": [
    "NLP", "Transformers", "Deep Learning", "Chain of Thought", "Reinforcement Learning", "Supervised Training/Fine-Tuning"
  ],
  "articleBody": "Introduction This paper is trying to address two things:\nLLM‚Äôs are bad at reasoning (specifically in complex problems). When they are able to reason, they cannot extrapolate to situations that differ from those it was trained on To address this, they gather a variety of math problems to start fine-tuning a model using Supervised Fine-Tuning (SFT) to enforce Chain-of-Thought (CoT) reasoning, as well as finetune the model to reverse problems using backward reasoning, where the final answer becomes part of the conditions, and the model figures out missing information. Once SFT has been completed, the model is then trained using a Reinforcement Learning (RL) paradigm using two reward models (PRM and BackPRM) to score the quality of the forward and backward reasoning steps, which is enforced using Proximal Policy Optimization (PPO), which refines the model based on feedback from the reward models defined.\nThis goal is to enforce both chain-of-thought reasoning, and the ability to restructure conditions and missing information. By doing so, they create a model that is capable of engaging with a complex problem through CoT reasoning, as well as adapt its ability to reason to more novel situations where the specific information that is missing and its conditions are not the same as examples it has been fine-tuned on i.e. it should in theory become more flexible in it‚Äôs problem-solving capabilities without relying strictly on memorization of CoT patterns.\nKey Contributions \u0026 Insights The results show that using SFT and RL produces models that are more capable at answering questions from a given testset of math questions than existing models. This may be caused by an increase in the adapability and flexibility of models that are trained using this paradigm in answering complex problems and engaging in efficient and structured problem solving.\nHowever, DeepSeek‚Äôs R1 model has a similar approach of RL, however instead of explicitly training the model with CoT examples and structured backward reasoning, DeepSeek directly uses RL to encourage step-by-step reasoning as an emergent behavior. This means that CoT reasoning naturally appears as a result of optimizing the reward function, rather than being explicitly trained through labeled CoT examples, which may lead to CoT reasoning being more deeply embedded within the weights of the model, and therefore be more likely to engage with CoT reasoning without being prompted to do so i.e. instead of requiring CoT-style inputs, the model may naturally adopt CoT reasoning across a broader range of problems as a defacto approach. Additionally, if a model implicitly learns structured reasoning patterns, it may be more likely to discover novel reasoning strategies on its own, some of which may be more effective than the ones we already know!\nAlthough DeepSeek‚Äôs approach may provide more general problem solving, the understanding of specific problems and concepts may be better captured via SFT and RL of the forward and backward problems as it provides direct examples of bidirectional learning and may encourage problem formulation to occur in a more systematic way. This is something that has been seen in DeepSeek where the CoT reasoning may not initially be obvious to the user/be foreign in its approach (non-readable to a human), yet the answer is correct.\nEvaluation of the Paper One of the issues with this paper is that there is a heavy reliance and dependence on manually curated backward reasoning data. This limits scalability and requires a human in the loop, which raises questions of accuracy/human-error within the dataset.\nIn comparison to DeepSeek‚Äôs R1 model, BackMATH uses PPO, which is more computationally expensive than GPRO used by DeepSeek, which raises questions about how adoptable and scalable its approach is in comparison to DeepSeek‚Äôs research.\nThe paper also assumes that training on backward reasoning helps models generalize to novel problems, which may not be fully true, and has not yet been fully proven. The model only improves by 1.6% on GSM8K and 2.1% on MATH, which are not significant in regards their comparison to competitor‚Äôs models. Additionally, real-world problems are often less defined and require an additional step of problem formulation for accurate complex problem solving, which the SFT examples lack. A broader evaluation of its problem-solving capabilities is required before proving this approach‚Äôs effectiveness in generalizaing to larger/differing domains beyond the training data.\nFinally, this paper primarily highlights successes but does not deeply analyze when and why the model still fails. So although, back-reasoning is a novel approach in its attempts to produce more effective reasoning, its lacks transparency/in-depth analysis of where the model may fall short and therefore does not explore when backward reasoning is not helpful for a model.\nFinal Thoughts BackMATH is well-motivated and approach to improving mathematical reasoning. It demonstrates that backward reasoning training can enhance problem-solving flexibility. However, it has scalability issues, computational inefficiencies, and uncertain generalization benefits. Future research should explore hybrid approaches combining self-supervised learning of structured reasoning training with emergent learning to build LLMs that are both interpretable and highly generalizable.\nAdditionally, the comparison between DeepSeek‚Äôs approach and BackMATH‚Äôs approach highlights potentially differing approaches to reasoning and rationality. It also raises the following questions:\nLanguages, Reasoning and Rationality Are languages that we use limiting our current approach to reasoning and rationality Could AI models develop more efficient or structured reasoning methods that differ from human linguistic reasoning? Would non-verbal or symbolic reasoning be a more optimal approach for AI reasoning? Will there be a new emergent language for reasoning that develop? Could neural networks evolve their own internal structures for logic and deduction, distinct from human cognition? Would such a system resemble mathematical logic, symbolic reasoning, or a novel form of abstract representation? Trust and Interpretability of Opaque AI Reasoning How can we trust opaque reasoning processes that produce correct outputs but are not interpretable? If a model like DeepSeek reasons in an unknown or non-human-readable way, how do we validate its correctness? Does the emergence of ‚Äúblack-box‚Äù AI reasoning present a fundamental limit to AI alignment? How to illuminate the opaque reasoning processes What interpretability methods (e.g., activation visualization, attribution analysis, mechanistic interpretability) can be applied? Are there patterns in AI-generated reasoning that can be reverse-engineered into human-understandable logic? Ethical Fine-Tuning of AI Reasoning How to safely fine-tune these processes to remain ethical will maintaining its efficacy What safeguards are needed to prevent emergent reasoning from diverging from human moral frameworks? Would we use Reinforcement Learning to develop ethics that align with human ethics Can we use Supervised Training/Fine-tuning to achieve the same results? Knowledge Representation in AI Do the weights of DeepSeek provide novel insights into our understanding of knowledge representations Could analyzing DeepSeek‚Äôs internal representations help us understand how AI models encode knowledge? Do AI systems create novel cognitive structures that challenge our existing understanding of epistemology and knowledge storage? ",
  "wordCount" : "1125",
  "inLanguage": "en",
  "datePublished": "2025-02-12T15:10:31Z",
  "dateModified": "2025-02-12T15:10:31Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://senankassem.com/posts/25-02-12-backmath-backward-reasoning/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Senan Kassem's Paper Reviews",
    "logo": {
      "@type": "ImageObject",
      "url": "https://senankassem.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js" integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>


<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://senankassem.com/" accesskey="h" title="Senan Kassem&#39;s Paper Reviews (Alt + H)">Senan Kassem&#39;s Paper Reviews</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      BackMATH - Towards Backward Reasoning for Solving Math Problems Step by Step
    </h1>
    <div class="post-meta"><span title='2025-02-12 15:10:31 +0000 UTC'>February 12, 2025</span>

<hr>
      <p>üìñ <strong>DOI:</strong> <a href="https://aclanthology.org/2025.coling-industry.40/" target="_blank">https://aclanthology.org/2025.coling-industry.40/</a></p><hr>
      <p>üìÇ <strong>PDF:</strong> <a href="https://aclanthology.org/2025.coling-industry.40.pdf" target="_blank">Download Paper</a></p>
    </div>
  </header> 
  <div class="post-content"><h3 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>This paper is trying to address two things:</p>
<blockquote>
<ol>
<li>LLM&rsquo;s are bad at reasoning (specifically in complex problems).</li>
<li>When they are able to reason, they cannot extrapolate to situations that differ from those it was trained on</li>
</ol></blockquote>
<p>To address this, they gather a variety of math problems to start fine-tuning a model using Supervised Fine-Tuning (SFT) to enforce Chain-of-Thought (CoT) reasoning, as well as finetune the model to reverse problems using backward reasoning, where the final answer becomes part of the conditions, and the model figures out missing information. Once SFT has been completed, the model is then trained using a Reinforcement Learning (RL) paradigm using two reward models (PRM and BackPRM) to score the quality of the forward and backward reasoning steps, which is enforced using Proximal Policy Optimization (PPO), which refines the model based on feedback from the reward models defined.</p>
<p>This goal is to enforce both chain-of-thought reasoning, and the ability to restructure conditions and missing information. By doing so, they create a model that is capable of engaging with a complex problem through CoT reasoning, as well as adapt its ability to reason to more novel situations where the specific information that is missing and its conditions are not the same as examples it has been fine-tuned on i.e. it should in theory become more flexible in it&rsquo;s problem-solving capabilities without relying strictly on memorization of CoT patterns.</p>
<hr>
<h3 id="key-contributions--insights">Key Contributions &amp; Insights<a hidden class="anchor" aria-hidden="true" href="#key-contributions--insights">#</a></h3>
<blockquote>
<p>The results show that <strong>using SFT and RL produces models that are more capable at answering questions</strong> from a given testset of math questions than existing models. This may be caused by an <strong>increase in the adapability and flexibility of models</strong> that are trained using this paradigm in answering complex problems and engaging in efficient and structured problem solving.</p></blockquote>
<p>However, DeepSeek&rsquo;s R1 model has a similar approach of RL, however instead of explicitly training the model with CoT examples and structured backward reasoning, DeepSeek directly uses RL to encourage step-by-step reasoning as an emergent behavior. This means that CoT reasoning naturally appears as a result of optimizing the reward function, rather than being explicitly trained through labeled CoT examples, which may lead to CoT reasoning being more deeply embedded within the weights of the model, and therefore be more likely to engage with CoT reasoning without being prompted to do so i.e. instead of requiring CoT-style inputs, the model may naturally adopt CoT reasoning across a broader range of problems as a defacto approach. Additionally, if a model implicitly learns structured reasoning patterns, it may be more likely to discover novel reasoning strategies on its own, some of which may be more effective than the ones we already know!</p>
<p>Although DeepSeek&rsquo;s approach may provide more general problem solving, the understanding of specific problems and concepts may be better captured via SFT and RL of the forward and backward problems as it provides direct examples of bidirectional learning and may encourage problem formulation to occur in a more systematic way. This is something that has been seen in DeepSeek where the CoT reasoning may not initially be obvious to the user/be foreign in its approach (non-readable to a human), yet the answer is correct.</p>
<hr>
<h3 id="evaluation-of-the-paper">Evaluation of the Paper<a hidden class="anchor" aria-hidden="true" href="#evaluation-of-the-paper">#</a></h3>
<p>One of the issues with this paper is that there is a heavy reliance and dependence on manually curated backward reasoning data. This limits scalability and requires a human in the loop, which raises questions of accuracy/human-error within the dataset.</p>
<p>In comparison to DeepSeek&rsquo;s R1 model, BackMATH uses PPO, which is more computationally expensive than GPRO used by DeepSeek, which raises questions about how adoptable and scalable its approach is in comparison to DeepSeek&rsquo;s research.</p>
<p>The paper also assumes that training on backward reasoning helps models generalize to novel problems, which may not be fully true, and has not yet been fully proven. The model only improves by 1.6% on GSM8K and 2.1% on MATH, which are not significant in regards their comparison to competitor&rsquo;s models. Additionally, real-world problems are often less defined and require an additional step of problem formulation for accurate complex problem solving, which the SFT examples lack. A broader evaluation of its problem-solving capabilities is required before proving this approach&rsquo;s effectiveness in generalizaing to larger/differing domains beyond the training data.</p>
<p>Finally, this paper primarily highlights successes but does not deeply analyze when and why the model still fails. So although, back-reasoning is a novel approach in its attempts to produce more effective reasoning, its lacks transparency/in-depth analysis of where the model may fall short and therefore does not explore when backward reasoning is not helpful for a model.</p>
<hr>
<h3 id="final-thoughts">Final Thoughts<a hidden class="anchor" aria-hidden="true" href="#final-thoughts">#</a></h3>
<p><em>BackMATH</em> is well-motivated and approach to improving mathematical reasoning. It demonstrates that <em>backward reasoning training can enhance problem-solving flexibility</em>. However, it has <em>scalability issues, computational inefficiencies, and uncertain generalization benefits</em>. Future research should explore hybrid approaches combining self-supervised learning of structured reasoning training with emergent learning to build LLMs that are both interpretable and highly generalizable.</p>
<p>Additionally, the comparison between DeepSeek&rsquo;s approach and BackMATH&rsquo;s approach highlights potentially differing approaches to reasoning and rationality. It also raises the following questions:</p>
<ol>
<li><em><strong>Languages, Reasoning and Rationality</strong></em>
<ul>
<li>Are languages that we use limiting our current approach to reasoning and rationality
<ul>
<li>Could AI models develop more efficient or structured reasoning methods that differ from human linguistic reasoning?</li>
<li>Would non-verbal or symbolic reasoning be a more optimal approach for AI reasoning?</li>
</ul>
</li>
<li>Will there be a new emergent language for reasoning that develop?
<ul>
<li>Could neural networks evolve their own internal structures for logic and deduction, distinct from human cognition?</li>
<li>Would such a system resemble mathematical logic, symbolic reasoning, or a novel form of abstract representation?</li>
</ul>
</li>
</ul>
</li>
<li><em><strong>Trust and Interpretability of Opaque AI Reasoning</strong></em>
<ul>
<li>How can we trust opaque reasoning processes that produce correct outputs but are not interpretable?
<ul>
<li>If a model like DeepSeek reasons in an unknown or non-human-readable way, how do we validate its correctness?</li>
<li>Does the emergence of &ldquo;black-box&rdquo; AI reasoning present a fundamental limit to AI alignment?</li>
</ul>
</li>
<li>How to illuminate the opaque reasoning processes
<ul>
<li>What interpretability methods (e.g., activation visualization, attribution analysis, mechanistic interpretability) can be applied?</li>
<li>Are there patterns in AI-generated reasoning that can be reverse-engineered into human-understandable logic?</li>
</ul>
</li>
</ul>
</li>
<li><em><strong>Ethical Fine-Tuning of AI Reasoning</strong></em>
<ul>
<li>How to safely fine-tune these processes to remain ethical will maintaining its efficacy
<ul>
<li>What safeguards are needed to prevent emergent reasoning from diverging from human moral frameworks?</li>
<li>Would we use Reinforcement Learning to develop ethics that align with human ethics</li>
<li>Can we use Supervised Training/Fine-tuning to achieve the same results?</li>
</ul>
</li>
</ul>
</li>
<li><em><strong>Knowledge Representation in AI</strong></em>
<ul>
<li>Do the weights of DeepSeek provide novel insights into our understanding of knowledge representations
<ul>
<li>Could analyzing DeepSeek‚Äôs internal representations help us understand how AI models encode knowledge?</li>
<li>Do AI systems create novel cognitive structures that challenge our existing understanding of epistemology and knowledge storage?</li>
</ul>
</li>
</ul>
</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://senankassem.com/">Senan Kassem&#39;s Paper Reviews</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
